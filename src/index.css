/* ========================================
   åœ°å›¾ç›¸å†Œ - æµ…è‰²ä¸»é¢˜ + ä¸°å¯ŒåŠ¨ç”»
   è®¾è®¡é£æ ¼ï¼šç®€æ´ã€æ˜äº®ã€æµç•…
======================================== */

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* ========== GPU åŠ é€Ÿä¼˜åŒ– ========== */
/* å¯¹é¢‘ç¹åŠ¨ç”»çš„å…ƒç´ å¯ç”¨ç¡¬ä»¶åŠ é€Ÿ */
/* æ³¨æ„ï¼šä¸è¦å¯¹ .marker-pin ä½¿ç”¨ transformï¼Œä¼šå½±å“ Mapbox å®šä½ */
.toolbar button,
.menu-btn,
.search-bar,
.search-result-item,
.photo-nav,
.photo-main-wrapper img,
.login-card,
.login-circle,
.context-menu,
.marker-list-panel,
.settings-panel,
.photo-viewer,
.notes-panel,
.photo-search-panel,
.photo-editor,
.feedback-toast {
  will-change: transform, opacity;
  transform: translateZ(0); /* å¼ºåˆ¶åˆ›å»ºåˆæˆå±‚ */
  backface-visibility: hidden; /* é˜²æ­¢é—ªçƒ */
}

:root {
  --bg-primary: #f8fafc;
  --bg-secondary: #ffffff;
  --bg-tertiary: #f1f5f9;
  --bg-hover: #e2e8f0;
  --border: #e2e8f0;
  --border-light: #f1f5f9;
  --text-primary: #1e293b;
  --text-secondary: #475569;
  --text-muted: #94a3b8;
  --accent: #3b82f6;
  --accent-hover: #2563eb;
  --accent-light: #dbeafe;
  --danger: #ef4444;
  --danger-light: #fee2e2;
  --success: #22c55e;
  --success-light: #dcfce7;
  --warning: #f59e0b;
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
  --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1);
  --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1);
  --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1);
  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 14px;
  --radius-xl: 20px;
  --mouse-x: 0px;
  --mouse-y: 0px;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Microsoft YaHei", sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  overflow: hidden;
  user-select: none;
  font-size: 14px;
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
}

.app {
  display: flex;
  height: 100vh;
  width: 100vw;
}

/* ========== æ— è¾¹æ¡†çª—å£æ‹–æ‹½åŒºåŸŸ ========== */
.window-drag-region {
  position: fixed;
  top: 0;
  left: 0;
  right: 140px; /* ç»™çª—å£æ§åˆ¶æŒ‰é’®ç•™ç©ºé—´ */
  height: 36px;
  -webkit-app-region: drag;
  z-index: 9999;
  pointer-events: auto;
}

/* æœç´¢æ ä¸å¯æ‹–æ‹½ */
.search-bar-container {
  -webkit-app-region: no-drag;
}

/* å·¥å…·æ æŒ‰é’®ä¸å¯æ‹–æ‹½ */
.toolbar, .toolbar button {
  -webkit-app-region: no-drag;
}

/* ========== åŠ¨ç”»å…³é”®å¸§ ========== */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(16px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-16px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideLeft {
  from { opacity: 0; transform: translateX(16px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes slideRight {
  from { opacity: 0; transform: translateX(-16px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-4px); }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px); }
  75% { transform: translateX(2px); }
}

@keyframes rippleOut {
  0% { width: 0; height: 0; opacity: 0.5; }
  100% { width: 60px; height: 60px; opacity: 0; }
}

@keyframes markerDrop {
  0% { 
    opacity: 0; 
    transform: translateY(-100px) scale(0.5); 
  }
  60% { 
    opacity: 1; 
    transform: translateY(10px) scale(1.1); 
  }
  80% { 
    transform: translateY(-5px) scale(0.95); 
  }
  100% { 
    opacity: 1; 
    transform: translateY(0) scale(1); 
  }
}

/* ========== åœ°å›¾ ========== */
.map-container {
  flex: 1;
  height: 100vh;
  position: relative;
}

.mapboxgl-canvas { cursor: crosshair; }
.mapboxgl-ctrl-logo, .mapboxgl-ctrl-attrib { opacity: 0.5; }

/* ========== ç‚¹å‡»æ¶Ÿæ¼ª ========== */
.click-ripple {
  position: fixed;
  pointer-events: none;
  z-index: 9999;
  transform: translate(-50%, -50%);
}

.click-ripple::before, .click-ripple::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  border: 2px solid var(--accent);
  animation: rippleOut 0.5s ease-out forwards;
}

.click-ripple::after { animation-delay: 0.1s; }

/* ========== ç™»å½•é¡µ ========== */
.login-page {
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
  position: relative;
  overflow: hidden;
}

.login-page.exiting {
  animation: fadeIn 0.5s ease reverse forwards;
}

.login-bg {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.login-circle {
  position: absolute;
  border-radius: 50%;
  filter: blur(80px);
  opacity: 0.6;
  transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.login-circle.c1 {
  width: 500px; height: 500px;
  background: rgba(59, 130, 246, 0.4);
  top: -150px; right: -150px;
  transform: translate(calc(var(--mouse-x) * -0.6), calc(var(--mouse-y) * -0.6));
}

.login-circle.c2 {
  width: 400px; height: 400px;
  background: rgba(139, 92, 246, 0.4);
  bottom: -100px; left: -100px;
  transform: translate(calc(var(--mouse-x) * 0.4), calc(var(--mouse-y) * 0.4));
}

.login-circle.c3 {
  width: 300px; height: 300px;
  background: rgba(34, 197, 94, 0.3);
  top: 50%; left: 50%;
  margin: -150px 0 0 -150px;
  transform: translate(calc(var(--mouse-x) * 0.2), calc(var(--mouse-y) * 0.2));
}

.login-card {
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(20px);
  padding: 48px 56px;
  border-radius: var(--radius-xl);
  text-align: center;
  box-shadow: var(--shadow-xl);
  position: relative;
  z-index: 1;
  animation: scaleIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
  min-width: 340px;
  /* GPU åŠ é€Ÿ */
  transform: translateZ(0);
}

.login-icon {
  font-size: 48px;
  margin-bottom: 16px;
  display: block;
  animation: bounce 2s ease-in-out infinite;
}

.login-card h1 {
  font-size: 24px;
  font-weight: 700;
  margin: 0 0 6px 0;
  color: var(--text-primary);
}

.login-card p {
  color: var(--text-secondary);
  font-size: 14px;
  margin: 0 0 28px 0;
}

.login-progress-wrap { margin-bottom: 24px; }

.login-progress {
  width: 100%;
  height: 4px;
  background: var(--bg-tertiary);
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 8px;
}

.login-progress-bar {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), #8b5cf6);
  border-radius: 2px;
  transition: width 0.15s ease-out;
}

.login-progress-text {
  font-size: 12px;
  color: var(--text-muted);
}

.login-btn {
  width: 100%;
  padding: 14px 28px;
  font-size: 15px;
  font-weight: 600;
  color: white;
  background: linear-gradient(135deg, var(--accent), #8b5cf6);
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.login-btn::before {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, transparent, rgba(255,255,255,0.2));
  opacity: 0;
  transition: opacity 0.2s;
}

.login-btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
}

.login-btn:hover:not(:disabled)::before { opacity: 1; }

.login-btn:active:not(:disabled) {
  transform: translateY(0) scale(0.98);
}

.login-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.login-footer {
  margin-top: 24px;
  font-size: 12px;
  color: var(--text-muted);
}

/* ========== åæ ‡æ˜¾ç¤º ========== */
.cursor-info {
  position: fixed;
  background: rgba(255, 255, 255, 0.95);
  color: var(--accent);
  padding: 4px 8px;
  font-size: 10px;
  font-weight: 600;
  font-family: "SF Mono", "Consolas", monospace;
  z-index: 100;
  pointer-events: none;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  border: 1px solid var(--border-light);
  white-space: nowrap;
  transition: opacity 0.15s;
}

/* ========== å·¥å…·æ  ========== */
.toolbar {
  position: fixed;
  top: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  z-index: 500;
}

.toolbar-left {
  left: 12px;
  animation: slideRight 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.toolbar-right {
  right: 12px;
  animation: slideLeft 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.toolbar button {
  width: 46px;
  height: 46px;
  min-width: 46px;
  min-height: 46px;
  border: 1px solid var(--border);
  background: white;
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: 14px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  overflow: hidden;
}

.toolbar button svg {
  width: 20px;
  height: 20px;
  transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.toolbar button::before {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--accent), #818cf8);
  opacity: 0;
  transition: opacity 0.25s;
  border-radius: 14px;
}

.toolbar button:hover {
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-3px) scale(1.05);
  box-shadow: 0 8px 24px rgba(99, 102, 241, 0.2);
}

.toolbar button:hover svg {
  transform: scale(1.2);
}

.toolbar button:hover::before {
  opacity: 0.1;
}

.toolbar button:active {
  transform: translateY(-1px) scale(0.98);
  transition-duration: 0.1s;
}

.toolbar button.active {
  background: linear-gradient(135deg, var(--accent), #818cf8);
  color: white;
  border-color: transparent;
  box-shadow: 0 4px 16px rgba(99, 102, 241, 0.3);
}

.toolbar button.active svg {
  stroke: white;
}

.toolbar button.active:hover {
  transform: translateY(-3px) scale(1.08);
  box-shadow: 0 8px 28px rgba(99, 102, 241, 0.4);
}

/* å·¦ä¾§å·¥å…·æ çš„æç¤ºæ˜¾ç¤ºåœ¨å³è¾¹ */
.toolbar-left [data-tooltip]::after {
  left: 100%;
  right: auto;
  transform: translateY(-50%) translateX(8px);
}

.toolbar-left [data-tooltip]:hover::after {
  transform: translateY(-50%) translateX(12px);
}

/* å³ä¾§å·¥å…·æ çš„æç¤ºæ˜¾ç¤ºåœ¨å·¦è¾¹ */
.toolbar-right [data-tooltip]::after {
  left: auto;
  right: 100%;
  transform: translateY(-50%) translateX(-8px);
}

.toolbar-right [data-tooltip]:hover::after {
  transform: translateY(-50%) translateX(-12px);
}


/* ========== æœç´¢æ  ========== */
.search-bar-container {
  position: fixed;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 600;
  width: 420px;
  max-width: calc(100vw - 180px);
  animation: searchBarEnter 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes searchBarEnter {
  0% { opacity: 0; transform: translateX(-50%) translateY(-20px) scale(0.95); }
  100% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
}

.search-bar {
  display: flex;
  align-items: center;
  background: white;
  border: 1px solid var(--border);
  padding: 6px 18px;
  height: 52px;
  gap: 12px;
  border-radius: 26px;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08), 0 1px 3px rgba(0, 0, 0, 0.05);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: text;
}

/* æ‰©å¤§æœç´¢æ ç‚¹å‡»åŒºåŸŸ - ä½¿ç”¨è´Ÿ z-index é¿å…é®æŒ¡å†…å®¹ */
.search-bar::after {
  content: "";
  position: absolute;
  inset: -8px;
  border-radius: 34px;
  z-index: -1;
}

.search-bar:hover {
  box-shadow: 0 6px 32px rgba(0, 0, 0, 0.12), 0 2px 6px rgba(0, 0, 0, 0.06);
  transform: translateY(-1px);
}

.search-bar:focus-within {
  border-color: var(--accent);
  box-shadow: 0 8px 40px rgba(99, 102, 241, 0.15), 0 0 0 3px rgba(99, 102, 241, 0.1);
  transform: translateY(-2px);
}

.search-icon {
  font-size: 16px;
  color: var(--text-muted);
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.search-bar:focus-within .search-icon {
  color: var(--accent);
  transform: scale(1.2) rotate(-10deg);
}

.search-bar input {
  flex: 1;
  border: none;
  outline: none;
  font-size: 15px;
  background: transparent;
  color: var(--text-primary);
  font-weight: 500;
  position: relative;
  z-index: 1;
}

.search-bar input::placeholder { 
  color: var(--text-muted); 
  font-weight: 400;
  transition: opacity 0.2s;
}

.search-bar:focus-within input::placeholder {
  opacity: 0.6;
}

.search-clear {
  width: 26px;
  height: 26px;
  border: none;
  background: var(--bg-tertiary);
  color: var(--text-muted);
  font-size: 11px;
  cursor: pointer;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
  animation: fadeIn 0.2s ease;
  position: relative;
  z-index: 1;
}

.search-clear:hover {
  background: var(--danger);
  color: white;
  transform: rotate(90deg) scale(1.15);
}

.search-clear:active {
  transform: rotate(90deg) scale(0.95);
}

.search-results {
  margin-top: 10px;
  background: white;
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: 0 8px 40px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.06);
  max-height: 340px;
  overflow-y: auto;
  overflow-x: hidden;
  animation: searchResultsEnter 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes searchResultsEnter {
  0% { opacity: 0; transform: translateY(-10px) scale(0.98); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}

.search-result-item {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 14px 16px;
  cursor: pointer;
  border-bottom: 1px solid var(--border-light);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  contain: layout style;
}

.search-result-item:last-child { border-bottom: none; }

.search-result-item::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: linear-gradient(180deg, var(--accent), #818cf8);
  transform: scaleY(0);
  transition: transform 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
  border-radius: 0 2px 2px 0;
}

.search-result-item:hover,
.search-result-item.selected {
  background: linear-gradient(90deg, var(--accent-light), transparent);
  padding-left: 20px;
}

.search-result-item:hover::before,
.search-result-item.selected::before {
  transform: scaleY(1);
}

.search-result-item:hover .result-icon {
  animation: bounce 0.4s ease;
}

.result-icon { font-size: 18px; flex-shrink: 0; }
.result-info { flex: 1; min-width: 0; }
.result-name { font-size: 14px; font-weight: 500; color: var(--text-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.result-address { font-size: 12px; color: var(--text-muted); margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.result-distance { font-size: 12px; color: var(--text-muted); flex-shrink: 0; margin-left: 8px; }

/* æœç´¢å†å² */
.search-history-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 14px;
  font-size: 12px;
  color: var(--text-muted);
  border-bottom: 1px solid var(--border-light);
}

.search-history-header button {
  background: none;
  border: none;
  color: var(--accent);
  cursor: pointer;
  font-size: 12px;
  padding: 2px 6px;
  border-radius: 4px;
}

.search-history-header button:hover {
  background: var(--accent-light);
}

.history-item .result-icon {
  color: var(--text-muted);
}

.search-tip {
  padding: 20px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}

.search-loading, .search-empty {
  padding: 28px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}

.search-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.loading-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
}

.search-overlay { position: fixed; inset: 0; z-index: 550; }

/* ========== å³ä¸‹è§’ç»Ÿè®¡æŒ‰é’® ========== */
.marker-count-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: var(--bg-secondary);
  color: var(--text-primary);
  padding: 10px 16px;
  font-size: 14px;
  font-weight: 600;
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  cursor: pointer;
  box-shadow: var(--shadow-md);
  z-index: 500;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.marker-count-btn:hover {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
  transform: translateY(-3px);
  box-shadow: var(--shadow-lg), 0 4px 12px rgba(59, 130, 246, 0.3);
}

.marker-count-btn:active {
  transform: translateY(-1px) scale(0.98);
}

/* ========== å³é”®èœå• ========== */
.context-menu {
  position: fixed;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  min-width: 240px;
  max-width: 280px;
  z-index: 1000;
  box-shadow: var(--shadow-xl);
  animation: scaleIn 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
  overflow: hidden;
  /* GPU åŠ é€Ÿ */
  transform: translateZ(0);
  will-change: transform, opacity;
}

.menu-close {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 24px;
  height: 24px;
  min-width: 24px;
  min-height: 24px;
  border: none;
  background: transparent;
  color: var(--text-muted);
  font-size: 12px;
  cursor: pointer;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  z-index: 10;
  opacity: 0.6;
}

.menu-close:hover {
  background: var(--danger);
  color: white;
  opacity: 1;
  transform: scale(1.1);
}

.menu-close:active {
  transform: scale(0.95);
}

.context-menu-header {
  padding: 12px 12px 10px;
  padding-right: 36px; /* ä¸ºå…³é—­æŒ‰é’®ç•™ç©ºé—´ */
  border-bottom: 1px solid var(--border-light);
  background: linear-gradient(180deg, var(--bg-tertiary), transparent);
}

.context-menu-header .place-name {
  color: var(--text-primary);
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 4px;
  line-height: 1.4;
  word-break: break-word;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.context-menu-header .meta-row {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.context-menu-header .coords {
  color: var(--text-muted);
  font-size: 11px;
  font-family: "SF Mono", "Consolas", monospace;
  font-weight: 500;
}

.context-menu-header .photo-count {
  color: var(--success);
  font-size: 11px;
  font-weight: 500;
}

.menu-actions { 
  padding: 6px; 
  display: flex;
  flex-direction: column;
  gap: 2px;
}

/* ä¸»è¦æ“ä½œæŒ‰é’®ï¼ˆæŸ¥çœ‹ç…§ç‰‡ã€æ·»åŠ ç…§ç‰‡ï¼‰æ¨ªå‘æ’åˆ— */
.menu-actions-primary {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
  margin-bottom: 4px;
}

.menu-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 10px 12px;
  min-height: 38px;
  border: none;
  background: transparent;
  color: var(--text-primary);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s ease;
  text-align: left;
  position: relative;
  overflow: hidden;
}

.menu-btn.primary {
  background: var(--accent-light);
  color: var(--accent);
  justify-content: center;
  flex-direction: row;
  gap: 8px;
  padding: 10px 12px;
  min-height: 42px;
  border-radius: 10px;
}

.menu-btn.primary:hover {
  background: var(--accent);
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);
}

.menu-btn.primary:active {
  transform: translateY(0);
  transition-duration: 0.1s;
}

.menu-btn.primary .btn-icon {
  font-size: 16px;
  transition: transform 0.2s ease;
}

.menu-btn.primary:hover .btn-icon {
  transform: scale(1.1);
}

.menu-btn.primary span:last-child {
  font-size: 13px;
  font-weight: 500;
}

.menu-btn:not(.primary)::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: var(--accent);
  transform: scaleY(0);
  transition: transform 0.2s;
}

.menu-btn:not(.primary):hover {
  background: var(--accent-light);
  color: var(--accent);
  transform: translateX(4px);
}

.menu-btn:not(.primary):hover::before { transform: scaleY(1); }

.menu-btn:hover .btn-icon {
  transform: scale(1.15);
}

.menu-btn.danger::before { background: var(--danger); }
.menu-btn.danger:hover {
  background: var(--danger-light);
  color: var(--danger);
}

.btn-icon {
  font-size: 15px;
  transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* æ·»åŠ ç…§ç‰‡åŒºåŸŸ */
.add-photo-zone {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 24px 16px;
  border: 2px dashed var(--border);
  background: var(--bg-tertiary);
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  margin: 4px 8px 8px;
}

.add-photo-zone:hover {
  border-color: var(--accent);
  background: var(--accent-light);
  transform: scale(1.02);
}

.add-photo-zone:hover .zone-icon {
  transform: scale(1.2) rotate(-10deg);
}

.add-photo-zone.drag-active {
  border-color: var(--accent);
  border-style: solid;
  background: var(--accent-light);
  animation: pulse 0.5s ease infinite;
}

.add-photo-zone .zone-icon {
  font-size: 28px;
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.add-photo-zone .zone-text { font-size: 14px; font-weight: 600; color: var(--accent); }
.add-photo-zone .zone-hint { font-size: 11px; color: var(--text-muted); }

.add-photo-zone.small { flex-direction: row; padding: 12px 14px; gap: 10px; margin: 0; }
.add-photo-zone.small .zone-icon { font-size: 18px; }

.zone-text-inline { font-size: 13px; font-weight: 500; color: var(--success); }

/* æ·»åŠ ç…§ç‰‡æŒ‰é’®ç‰¹æ®Šæ ·å¼ */
.menu-btn.primary.add {
  background: var(--success-light, rgba(16, 185, 129, 0.1));
  color: var(--success);
}

.menu-btn.primary.add:hover {
  background: var(--success);
  color: white;
}

.menu-btn.primary.drag-active {
  background: var(--success);
  color: white;
  animation: pulse 0.5s ease infinite;
}

.context-overlay { position: fixed; inset: 0; z-index: 800; }

/* ========== æ ‡è®°å›¾é’‰ ========== */
.marker-pin {
  cursor: pointer;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15));
  transition: filter 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.marker-pin:hover {
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
}

.marker-photo-preview {
  position: relative;
  width: 48px;
  height: 48px;
  border: 3px solid white;
  background: var(--bg-tertiary);
  margin-bottom: 3px;
  border-radius: var(--radius-md);
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  transition: border-color 0.2s;
}

.marker-pin:hover .marker-photo-preview {
  border-color: var(--accent);
}

.marker-photo-preview img { width: 100%; height: 100%; object-fit: cover; }

.photo-badge {
  position: absolute;
  top: -4px;
  right: -4px;
  background: var(--accent);
  color: white;
  font-size: 10px;
  padding: 2px 6px;
  border-radius: 10px;
  font-weight: 600;
  box-shadow: var(--shadow-sm);
}

/* ========== æ ‡è®°åˆ—è¡¨ ========== */
.marker-list-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  backdrop-filter: blur(4px);
  z-index: 1500;
  display: flex;
  align-items: flex-end;
  justify-content: flex-end;
  padding: 20px;
  padding-bottom: 72px;
  animation: fadeIn 0.2s;
}

.marker-list-panel {
  background: var(--bg-secondary);
  border-radius: var(--radius-xl);
  width: 400px;
  max-height: calc(100vh - 80px);
  min-height: 500px;
  display: flex;
  flex-direction: column;
  box-shadow: var(--shadow-xl);
  animation: slideLeft 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
}

.marker-list-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-light);
  background: linear-gradient(180deg, var(--bg-tertiary), transparent);
}

.marker-list-header h3 { margin: 0; font-size: 16px; font-weight: 600; }

.panel-close {
  width: 30px;
  height: 30px;
  border: none;
  background: var(--bg-tertiary);
  color: var(--text-muted);
  font-size: 14px;
  cursor: pointer;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.panel-close:hover {
  background: var(--danger);
  color: white;
  transform: rotate(90deg) scale(1.1);
}

.marker-list-toolbar {
  padding: 14px 16px;
  border-bottom: 1px solid var(--border-light);
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.marker-search {
  width: 100%;
  padding: 10px 14px;
  border: 1px solid var(--border);
  background: var(--bg-primary);
  color: var(--text-primary);
  font-size: 13px;
  border-radius: var(--radius-md);
  outline: none;
  transition: all 0.2s;
}

.marker-search:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-light);
}

.marker-search::placeholder { color: var(--text-muted); }

.sort-btns { display: flex; gap: 8px; }

.sort-btns button {
  flex: 1;
  padding: 9px 12px;
  border: 1px solid var(--border);
  background: var(--bg-secondary);
  color: var(--text-secondary);
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.sort-btns button:hover {
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-1px);
}

.sort-btns button.active {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
}

.marker-list-content { flex: 1; overflow-y: auto; padding: 10px; }

.marker-list-item {
  display: flex;
  gap: 12px;
  padding: 12px;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  margin-bottom: 6px;
  border: 1px solid transparent;
  contain: layout style;
}

.marker-list-item:hover {
  background: var(--accent-light);
  border-color: var(--accent);
  transform: translateX(4px);
}

.marker-list-item:hover .marker-list-thumb {
  transform: scale(1.05);
}

.marker-list-thumb {
  width: 56px;
  height: 56px;
  object-fit: cover;
  flex-shrink: 0;
  border-radius: var(--radius-md);
  background: var(--bg-tertiary);
  box-shadow: var(--shadow-sm);
  transition: transform 0.2s;
}

.marker-list-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 4px;
  min-width: 0;
}

.marker-list-name {
  font-size: 14px;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.marker-list-note {
  font-size: 12px;
  color: var(--accent);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  opacity: 0.9;
}

.marker-list-meta { font-size: 12px; color: var(--text-muted); }

.marker-list-empty {
  text-align: center;
  color: var(--text-muted);
  padding: 40px 20px;
  font-size: 13px;
}

.marker-list-empty::before {
  content: "ğŸ“";
  display: block;
  font-size: 32px;
  margin-bottom: 10px;
  opacity: 0.5;
}

/* æœç´¢ç»“æœåˆ†ç»„ */
.search-results-grouped {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.result-group {
  background: var(--bg-tertiary);
  border-radius: var(--radius-lg);
  padding: 12px;
}

.result-group-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  margin-bottom: 10px;
  padding-left: 4px;
}

.result-group .marker-list-item {
  margin-bottom: 4px;
}

.result-group .marker-list-item:last-child {
  margin-bottom: 0;
}

.note-item .marker-list-name {
  color: var(--accent);
  font-style: italic;
}

.result-more {
  text-align: center;
  font-size: 12px;
  color: var(--text-muted);
  padding: 8px;
  border-top: 1px dashed var(--border-light);
  margin-top: 8px;
}

/* ========== ç…§ç‰‡æŸ¥çœ‹å™¨ ========== */
.photo-viewer {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.95);
  z-index: 2000;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  animation: fadeIn 0.25s;
  contain: strict;
}

.photo-main-wrapper {
  max-width: 90vw;
  max-height: 85vh;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: grab;
  overflow: hidden;
  animation: scaleIn 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.photo-main-wrapper:active { cursor: grabbing; }

.photo-main-wrapper img {
  max-width: 100%;
  max-height: 85vh;
  object-fit: contain;
  user-select: none;
  border-radius: var(--radius-md);
  /* GPU åŠ é€Ÿ - å¹³æ»‘ç¼©æ”¾å’Œæ‹–åŠ¨ */
  will-change: transform;
  transform-origin: center center;
  backface-visibility: hidden;
}

.photo-nav {
  position: fixed;
  top: 50%;
  transform: translateY(-50%);
  width: 48px;
  height: 48px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border: 1px solid var(--border-light);
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 2100;
}

.photo-nav svg {
  width: 22px;
  height: 22px;
}

.photo-nav.prev { left: 24px; }
.photo-nav.next { right: 24px; }

.photo-nav:hover {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
  transform: translateY(-50%) scale(1.08);
  box-shadow: var(--shadow-xl), 0 4px 12px rgba(59, 130, 246, 0.4);
}

.photo-nav:active {
  transform: translateY(-50%) scale(0.95);
}

/* ç…§ç‰‡å®¹å™¨ - åŒ…å«å›¾ç‰‡å’Œä¾§è¾¹å·¥å…·æ  */
.photo-container {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 20px;
  animation: scaleIn 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* ä¾§è¾¹å·¥å…·æ  - ç´§è´´ç…§ç‰‡å³ä¾§ï¼Œç«–å‘æ’åˆ— */
.photo-toolbar-side {
  display: flex !important;
  flex-direction: column !important;
  flex-wrap: nowrap !important;
  gap: 10px;
  padding: 14px 10px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  z-index: 2100;
}

.photo-toolbar-side .toolbar-btn {
  width: 48px;
  height: 48px;
  min-width: 48px;
  min-height: 48px;
  background: transparent;
  border: 1px solid var(--border-light);
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

.photo-toolbar-side .toolbar-btn svg {
  width: 24px;
  height: 24px;
}

.photo-toolbar-side .toolbar-btn:hover {
  background: var(--accent-light);
  border-color: var(--accent);
  color: var(--accent);
  transform: scale(1.08);
}

.photo-toolbar-side .toolbar-btn.danger:hover {
  background: var(--danger-light);
  border-color: var(--danger);
  color: var(--danger);
}

.photo-toolbar-side .toolbar-btn.close:hover {
  background: var(--danger);
  border-color: var(--danger);
  color: white;
}

.photo-toolbar-side .toolbar-divider {
  height: 1px;
  background: var(--border-light);
  margin: 4px 0;
}

/* Hover æç¤º - æ‰€æœ‰å¸¦ data-tooltip çš„æŒ‰é’® */
[data-tooltip] {
  position: relative;
}

[data-tooltip]::after {
  content: attr(data-tooltip);
  position: absolute;
  left: 100%;
  top: 50%;
  transform: translateY(-50%) translateX(8px);
  padding: 6px 10px;
  background: var(--text-primary);
  color: white;
  font-size: 12px;
  font-weight: 500;
  white-space: nowrap;
  border-radius: var(--radius-sm);
  opacity: 0;
  visibility: hidden;
  transition: all 0.2s ease;
  pointer-events: none;
  z-index: 9999;
}

[data-tooltip]:hover::after {
  opacity: 1;
  visibility: visible;
  transform: translateY(-50%) translateX(12px);
}

/* å·¦ä¾§æŒ‰é’®çš„æç¤ºæ˜¾ç¤ºåœ¨å³è¾¹ */
.photo-nav.prev[data-tooltip]::after {
  left: 100%;
  right: auto;
}

/* å³ä¾§æŒ‰é’®çš„æç¤ºæ˜¾ç¤ºåœ¨å·¦è¾¹ */
.photo-nav.next[data-tooltip]::after {
  left: auto;
  right: 100%;
  transform: translateY(-50%) translateX(-8px);
}

.photo-nav.next[data-tooltip]:hover::after {
  transform: translateY(-50%) translateX(-12px);
}

/* ä¾§è¾¹å·¥å…·æ çš„æç¤ºæ˜¾ç¤ºåœ¨å·¦è¾¹ */
.photo-toolbar-side [data-tooltip]::after {
  left: auto;
  right: 100%;
  transform: translateY(-50%) translateX(-8px);
}

.photo-toolbar-side [data-tooltip]:hover::after {
  transform: translateY(-50%) translateX(-12px);
}

/* ç…§ç‰‡ä¸»åŒ…è£…å™¨ - ç§»é™¤ç‹¬ç«‹åŠ¨ç”»ï¼Œç”±å®¹å™¨æ§åˆ¶ */
.photo-container .photo-main-wrapper {
  animation: none;
}

/* ç…§ç‰‡æŸ¥çœ‹å™¨é¡¶éƒ¨å·¥å…·æ  */
.pv-toolbar {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(12px);
  border-radius: 12px;
  z-index: 2200;
}

.pv-btn {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  border-radius: 10px;
  color: rgba(255,255,255,0.8);
  cursor: pointer;
  transition: all 0.15s ease;
}

.pv-btn svg {
  width: 22px;
  height: 22px;
  fill: currentColor;
}

.pv-btn:hover {
  background: rgba(255,255,255,0.15);
  color: white;
}

.pv-btn:active {
  transform: scale(0.92);
}

.pv-btn-danger:hover {
  background: rgba(239, 68, 68, 0.25);
  color: #fca5a5;
}

.pv-btn-accent:hover {
  background: rgba(59, 130, 246, 0.25);
  color: #93c5fd;
}

.pv-btn-close {
  background: rgba(239, 68, 68, 0.2);
  color: #fca5a5;
}

.pv-btn-close:hover {
  background: #ef4444;
  color: white;
}

.pv-divider {
  width: 1px;
  height: 24px;
  background: rgba(255,255,255,0.2);
  margin: 0 4px;
}

.photo-bottom-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 16px 24px 20px;
  background: linear-gradient(transparent, rgba(0,0,0,0.7));
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  z-index: 2100;
}

.photo-edit-hint {
  font-size: 12px;
  color: rgba(255,255,255,0.7);
  background: rgba(59, 130, 246, 0.3);
  padding: 4px 12px;
  border-radius: 12px;
}

.crop-mode { cursor: crosshair; }

.crop-hint {
  position: fixed;
  top: 80px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.7);
  color: white;
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 13px;
  z-index: 2300;
}

.crop-overlay {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 2150;
}

.crop-selection {
  border: 2px dashed #3b82f6;
  background: rgba(59, 130, 246, 0.15);
  box-shadow: 0 0 0 9999px rgba(0,0,0,0.5);
}

.pv-btn-active {
  background: rgba(59, 130, 246, 0.3) !important;
  color: #60a5fa !important;
}

.photo-counter {
  font-size: 14px;
  font-weight: 600;
  color: white;
  letter-spacing: 2px;
  background: rgba(255,255,255,0.15);
  padding: 8px 18px;
  border-radius: var(--radius-lg);
  backdrop-filter: blur(10px);
}

.photo-note-bar {
  font-size: 14px;
  color: rgba(255,255,255,0.85);
  max-width: 560px;
  text-align: center;
  line-height: 1.6;
}

/* ========== ç…§ç‰‡ä¿¡æ¯é¢æ¿ ========== */
.photo-info-panel {
  position: fixed;
  right: 20px;
  top: 80px;
  bottom: 100px;
  width: 280px;
  background: rgba(30, 30, 30, 0.95);
  backdrop-filter: blur(20px);
  border-radius: var(--radius-xl);
  z-index: 2200;
  display: flex;
  flex-direction: column;
  animation: slideLeft 0.25s ease;
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 8px 32px rgba(0,0,0,0.4);
}

.photo-info-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px 16px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.photo-info-header h4 {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
  color: white;
}

.panel-close-sm {
  width: 24px;
  height: 24px;
  border: none;
  background: rgba(255,255,255,0.1);
  color: rgba(255,255,255,0.7);
  font-size: 12px;
  cursor: pointer;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.panel-close-sm:hover {
  background: rgba(255,100,100,0.8);
  color: white;
}

.photo-info-content {
  flex: 1;
  overflow-y: auto;
  padding: 12px;
}

.info-section {
  margin-bottom: 16px;
}

.info-section:last-child {
  margin-bottom: 0;
}

.info-title {
  font-size: 11px;
  font-weight: 600;
  color: rgba(255,255,255,0.5);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
  padding-left: 2px;
}

.info-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 8px;
  background: rgba(255,255,255,0.05);
  border-radius: var(--radius-sm);
  margin-bottom: 4px;
}

.info-row:last-child {
  margin-bottom: 0;
}

.info-label {
  font-size: 12px;
  color: rgba(255,255,255,0.6);
}

.info-value {
  font-size: 12px;
  color: white;
  font-weight: 500;
  text-align: right;
  max-width: 160px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.info-loading {
  text-align: center;
  color: rgba(255,255,255,0.5);
  padding: 40px 20px;
  font-size: 13px;
}

.toolbar-btn.active {
  background: var(--accent);
  color: white;
}

/* ========== è®¾ç½®é¢æ¿ ========== */
.settings-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(4px);
  z-index: 1800;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  animation: fadeIn 0.2s;
}

.settings-panel {
  background: var(--bg-secondary);
  border-radius: var(--radius-xl);
  width: 100%;
  max-width: 840px;
  height: 560px;
  max-height: calc(100vh - 48px);
  display: flex;
  box-shadow: var(--shadow-xl);
  animation: scaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  overflow: hidden;
}

/* å·¦ä¾§å¯¼èˆª */
.settings-nav {
  width: 200px;
  background: var(--bg-tertiary);
  border-right: 1px solid var(--border-light);
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
}

.settings-nav-header {
  padding: 20px 18px;
  display: flex;
  align-items: center;
  gap: 10px;
  border-bottom: 1px solid var(--border-light);
}

.settings-nav-header .nav-icon { font-size: 22px; }
.settings-nav-header .nav-title { font-size: 17px; font-weight: 700; color: var(--text-primary); }

.settings-nav-items {
  flex: 1;
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.settings-nav-items button {
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
  padding: 12px 14px;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  text-align: left;
  position: relative;
  overflow: hidden;
}

.settings-nav-items button span { font-size: 17px; }

.settings-nav-items button::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: var(--accent);
  transform: scaleY(0);
  transition: transform 0.2s;
}

.settings-nav-items button:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  transform: translateX(4px);
}

.settings-nav-items button:hover::before { transform: scaleY(1); }

.settings-nav-items button.active {
  background: var(--accent);
  color: white;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
}

.settings-nav-items button.active::before { transform: scaleY(0); }

/* å³ä¾§å†…å®¹ */
.settings-content {
  flex: 1;
  overflow-y: auto;
  padding: 24px;
  position: relative;
  display: flex;
  flex-direction: column;
}

.settings-close {
  position: absolute;
  top: 16px;
  right: 16px;
  width: 32px;
  height: 32px;
  border: none;
  background: var(--bg-tertiary);
  color: var(--text-muted);
  font-size: 14px;
  cursor: pointer;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 10;
}

.settings-close:hover {
  background: var(--danger);
  color: white;
  transform: rotate(90deg) scale(1.1);
}

/* è®¾ç½®é¡µé¢ */
.settings-page {
  flex: 1;
  animation: slideUp 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.settings-page h2 {
  margin: 0 0 6px 0;
  font-size: 20px;
  font-weight: 700;
  color: var(--text-primary);
}

.settings-page .page-desc {
  margin: 0 0 24px 0;
  font-size: 14px;
  color: var(--text-muted);
}

/* è®¾ç½®ç»„ */
.setting-group {
  margin-bottom: 24px;
  padding: 18px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-light);
  transition: all 0.2s;
}

.setting-group:hover {
  border-color: var(--border);
  box-shadow: var(--shadow-sm);
}

.setting-group h3 {
  margin: 0 0 14px 0;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* è®¾ç½®è¡Œ */
.setting-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px 0;
  border-bottom: 1px solid var(--border-light);
  transition: all 0.15s;
}

.setting-row:hover {
  background: rgba(59, 130, 246, 0.03);
  margin: 0 -8px;
  padding-left: 8px;
  padding-right: 8px;
  border-radius: var(--radius-sm);
}

.setting-row:last-child { border-bottom: none; padding-bottom: 0; }
.setting-row:first-of-type { padding-top: 0; }

.setting-label { flex: 1; min-width: 0; }

.setting-label strong {
  display: block;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 3px;
}

.setting-label span {
  display: block;
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.4;
}

/* å¼€å…³ */
.switch {
  position: relative;
  width: 46px;
  height: 26px;
  flex-shrink: 0;
  margin-left: 14px;
}

.switch input { opacity: 0; width: 0; height: 0; }

.switch .slider {
  position: absolute;
  cursor: pointer;
  inset: 0;
  background: var(--border);
  border-radius: 13px;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.switch .slider::before {
  content: "";
  position: absolute;
  width: 20px;
  height: 20px;
  left: 3px;
  top: 3px;
  background: white;
  border-radius: 50%;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: var(--shadow-sm);
}

.switch:hover .slider { background: var(--text-muted); }

.switch input:checked + .slider {
  background: var(--accent);
}

.switch input:checked + .slider::before {
  transform: translateX(20px);
}

/* æ»‘å— */
.range-control {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
  margin-left: 14px;
}

.range-control input[type="range"] {
  width: 100px;
  height: 4px;
  background: var(--border);
  border: none;
  outline: none;
  cursor: pointer;
  -webkit-appearance: none;
  appearance: none;
  border-radius: 2px;
  transition: background 0.2s;
}

.range-control.wide input[type="range"] { width: 140px; }

.range-control input[type="range"]:hover { background: var(--text-muted); }

.range-control input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 16px;
  height: 16px;
  background: var(--accent);
  cursor: pointer;
  border-radius: 50%;
  box-shadow: var(--shadow-sm);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.range-control input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.2);
  box-shadow: var(--shadow-md), 0 0 0 4px var(--accent-light);
}

.range-control .range-value {
  min-width: 44px;
  text-align: right;
  font-size: 13px;
  font-weight: 600;
  color: var(--accent);
}

/* æç¤º */
.setting-tip {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 14px;
  background: var(--accent-light);
  border-radius: var(--radius-md);
  margin-top: 20px;
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.setting-tip span { font-size: 16px; flex-shrink: 0; }
.setting-tip p { margin: 0; font-size: 13px; color: var(--text-secondary); line-height: 1.5; }

/* å­˜å‚¨å¡ç‰‡ */
.storage-cards {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-bottom: 24px;
}

.storage-card {
  background: var(--bg-secondary);
  border: 1px solid var(--border-light);
  border-radius: var(--radius-lg);
  padding: 18px;
  text-align: center;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.storage-card:hover {
  border-color: var(--accent);
  transform: translateY(-4px);
  box-shadow: var(--shadow-md);
}

.storage-card:hover .storage-icon {
  transform: scale(1.2);
}

.storage-card .storage-icon {
  font-size: 26px;
  margin-bottom: 8px;
  transition: transform 0.2s;
}

.storage-card .storage-value {
  font-size: 26px;
  font-weight: 700;
  color: var(--text-primary);
  line-height: 1.2;
}

.storage-card .storage-label {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 4px;
  text-transform: uppercase;
}

/* æ“ä½œæŒ‰é’® */
.action-buttons { display: flex; flex-direction: column; gap: 10px; }

.action-btn {
  display: flex;
  align-items: center;
  gap: 14px;
  width: 100%;
  padding: 14px 16px;
  border: 1px solid var(--border-light);
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 14px;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  text-align: left;
}

.action-btn span {
  font-size: 22px;
  flex-shrink: 0;
  transition: transform 0.2s;
}

.action-btn div { flex: 1; }
.action-btn strong { display: block; font-size: 14px; font-weight: 600; margin-bottom: 2px; }
.action-btn small { display: block; font-size: 12px; color: var(--text-muted); }

.action-btn:hover {
  border-color: var(--accent);
  background: var(--accent-light);
  transform: translateX(4px);
}

.action-btn:hover span { transform: scale(1.15); }

.action-btn.danger:hover {
  border-color: var(--danger);
  background: var(--danger-light);
  color: var(--danger);
}

/* å…³äºé¡µé¢ */
.about-page { text-align: center; }

.about-header { margin-bottom: 20px; }

.about-header .about-icon {
  font-size: 56px;
  margin-bottom: 12px;
  display: block;
  animation: bounce 2s ease-in-out infinite;
}

.about-header h1 { margin: 0 0 6px 0; font-size: 26px; font-weight: 700; color: var(--text-primary); }
.about-header .version {
  display: inline-block;
  padding: 4px 14px;
  background: var(--accent-light);
  color: var(--accent);
  font-size: 12px;
  font-weight: 600;
  border-radius: 20px;
}

.about-page .about-desc {
  font-size: 14px;
  color: var(--text-secondary);
  margin-bottom: 28px;
  line-height: 1.6;
}

.about-features {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  margin-bottom: 28px;
  text-align: left;
}

.about-features .feature {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 14px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-md);
  border: 1px solid var(--border-light);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.about-features .feature:hover {
  border-color: var(--accent);
  background: var(--accent-light);
  transform: translateY(-2px);
}

.about-features .feature:hover span { transform: scale(1.2); }

.about-features .feature span {
  font-size: 22px;
  flex-shrink: 0;
  transition: transform 0.2s;
}

.about-features .feature strong { display: block; font-size: 13px; font-weight: 600; color: var(--text-primary); margin-bottom: 2px; }
.about-features .feature small { display: block; font-size: 11px; color: var(--text-muted); }

.dev-tools-section {
  margin-top: 20px;
  padding: 16px;
  background: var(--bg-secondary);
  border-radius: var(--radius-md);
  border: 1px solid var(--border-light);
}

.dev-tools-section h3 {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.dev-tools-btns {
  display: flex;
  gap: 10px;
}

.dev-tools-btns button {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 10px 16px;
  background: var(--bg-primary);
  border: 1px solid var(--border-light);
  border-radius: var(--radius-md);
  color: var(--text-secondary);
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
}

.dev-tools-btns button:hover {
  background: var(--accent-light);
  border-color: var(--accent);
  color: var(--accent);
}

.about-footer { padding-top: 18px; border-top: 1px solid var(--border-light); margin-top: 20px; }
.about-footer p { margin: 0; font-size: 12px; color: var(--text-muted); }

/* è®¾ç½®é¡µåº•éƒ¨ä¿å­˜åŒº - å›ºå®šåœ¨åº•éƒ¨å³ä¸‹è§’ */
.settings-footer {
  position: sticky;
  bottom: 0;
  left: 0;
  right: 0;
  margin: auto -24px -24px -24px;
  padding: 16px 24px;
  background: linear-gradient(transparent, var(--bg-secondary) 20%);
  border-top: 1px solid var(--border-light);
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 16px;
  z-index: 10;
  flex-direction: row-reverse;
}

.settings-footer .save-hint {
  font-size: 12px;
  color: var(--text-muted);
  margin: 0;
  flex: 1;
  text-align: left;
}

.settings-footer .save-btn {
  padding: 12px 28px;
  background: var(--accent);
  border: none;
  color: white;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
}

.settings-footer .save-btn:hover:not(:disabled) {
  background: var(--accent-hover);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
}

.settings-footer .save-btn:active:not(:disabled) {
  transform: translateY(0) scale(0.98);
}

.settings-footer .save-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  box-shadow: none;
}


/* ========== å¤‡æ³¨é¢æ¿ ========== */
.notes-panel-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(4px);
  z-index: 1900;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  animation: fadeIn 0.2s;
}

.notes-panel {
  background: var(--bg-secondary);
  border-radius: var(--radius-xl);
  width: 100%;
  max-width: 560px;
  max-height: calc(100vh - 48px);
  display: flex;
  flex-direction: column;
  box-shadow: var(--shadow-xl);
  animation: scaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  overflow: hidden;
}

.notes-panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 18px 20px;
  border-bottom: 1px solid var(--border-light);
  background: linear-gradient(180deg, var(--bg-tertiary), transparent);
}

.notes-panel-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.notes-panel-header .header-actions {
  display: flex;
  gap: 8px;
  align-items: center;
}

.notes-panel-header .edit-btn,
.notes-panel-header .cancel-btn,
.notes-panel-header .save-btn {
  padding: 8px 14px;
  border: 1px solid var(--border);
  background: var(--bg-secondary);
  color: var(--text-secondary);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.notes-panel-header .edit-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-1px);
}

.notes-panel-header .save-btn {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}

.notes-panel-header .save-btn:hover {
  background: var(--accent-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
}

.notes-list {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

.note-item {
  display: flex;
  gap: 14px;
  padding: 14px;
  background: var(--bg-tertiary);
  border-radius: var(--radius-lg);
  margin-bottom: 12px;
  border: 1px solid var(--border-light);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.note-item:hover {
  border-color: var(--border);
  transform: translateX(4px);
}

.note-item:last-child { margin-bottom: 0; }

.note-thumb {
  width: 72px;
  height: 72px;
  object-fit: cover;
  flex-shrink: 0;
  border-radius: var(--radius-md);
  background: var(--bg-hover);
  box-shadow: var(--shadow-sm);
  transition: transform 0.2s;
}

.note-item:hover .note-thumb {
  transform: scale(1.05);
}

.note-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-width: 0;
}

.note-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
}

.note-text {
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.5;
}

.note-content textarea {
  flex: 1;
  min-height: 60px;
  padding: 10px 12px;
  border: 1px solid var(--border);
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 14px;
  border-radius: var(--radius-md);
  resize: none;
  outline: none;
  transition: all 0.2s;
  font-family: inherit;
}

.note-content textarea:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-light);
}

/* ========== å¤‡æ³¨ç¼–è¾‘å™¨ ========== */
.note-editor-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(4px);
  z-index: 2500;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  animation: fadeIn 0.2s;
}

.note-editor {
  background: var(--bg-secondary);
  border-radius: var(--radius-xl);
  padding: 24px;
  width: 100%;
  max-width: 480px;
  box-shadow: var(--shadow-xl);
  animation: scaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.note-editor h3 {
  margin: 0 0 16px 0;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
}

.note-editor textarea {
  width: 100%;
  min-height: 120px;
  padding: 14px;
  border: 1px solid var(--border);
  background: var(--bg-tertiary);
  color: var(--text-primary);
  font-size: 14px;
  border-radius: var(--radius-md);
  resize: vertical;
  outline: none;
  transition: all 0.2s;
  font-family: inherit;
  line-height: 1.6;
}

.note-editor textarea:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-light);
}

.note-editor-btns {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 16px;
}

.note-editor-btns button {
  padding: 10px 20px;
  border: 1px solid var(--border);
  background: var(--bg-secondary);
  color: var(--text-secondary);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.note-editor-btns button:hover {
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-1px);
}

.note-editor-btns button.save {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}

.note-editor-btns button.save:hover {
  background: var(--accent-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
}

/* ========== æµ‹é‡æ¨¡å¼ ========== */
.map-container.measure-mode { cursor: crosshair !important; }
.map-container.measure-mode .mapboxgl-canvas { cursor: crosshair !important; }

.measure-hint {
  position: fixed;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-secondary);
  color: var(--text-primary);
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  z-index: 600;
  animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid var(--border);
}

.measure-toolbar {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 10px;
  z-index: 600;
  animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.measure-btn {
  padding: 12px 20px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  color: var(--text-primary);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.measure-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.measure-btn.exit {
  background: var(--danger);
  color: white;
  border-color: var(--danger);
}

.measure-btn.exit:hover {
  background: #dc2626;
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg), 0 4px 12px rgba(239, 68, 68, 0.3);
}

/* ========== æ»šåŠ¨æ¡ ========== */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 4px;
  transition: background 0.2s;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted);
}

/* ========== å“åº”å¼ ========== */
@media (max-width: 768px) {
  .settings-panel {
    flex-direction: column;
    height: auto;
    max-height: 90vh;
  }
  
  .settings-nav {
    width: 100%;
    border-right: none;
    border-bottom: 1px solid var(--border-light);
  }
  
  .settings-nav-items {
    flex-direction: row;
    overflow-x: auto;
    padding: 8px;
    gap: 6px;
  }
  
  .settings-nav-items button {
    flex-shrink: 0;
    padding: 10px 14px;
  }
  
  .storage-cards {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .about-features {
    grid-template-columns: 1fr;
  }
  
  .search-bar-container {
    width: calc(100vw - 120px);
    max-width: none;
  }
  
  .marker-list-panel {
    width: 100%;
    max-width: none;
  }
}

/* ========== å·¥å…·ç±» ========== */
.tooltip {
  position: relative;
}

.tooltip::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(-4px);
  padding: 6px 10px;
  background: var(--text-primary);
  color: var(--bg-secondary);
  font-size: 12px;
  font-weight: 500;
  white-space: nowrap;
  border-radius: var(--radius-sm);
  opacity: 0;
  visibility: hidden;
  transition: all 0.2s;
  pointer-events: none;
  z-index: 9999;
}

.tooltip:hover::after {
  opacity: 1;
  visibility: visible;
  transform: translateX(-50%) translateY(-8px);
}

.loading-spinner {
  width: 24px;
  height: 24px;
  border: 2px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
}

.skeleton {
  background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--bg-hover) 50%, var(--bg-tertiary) 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
  border-radius: var(--radius-sm);
}

@keyframes skeleton-loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* ========== éª¨æ¶å± ========== */
.skeleton-marker {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.skeleton-thumb {
  width: 48px;
  height: 48px;
  border-radius: var(--radius-md);
  background: linear-gradient(90deg, #e2e8f0 25%, #f1f5f9 50%, #e2e8f0 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.2s ease-in-out infinite;
  margin-bottom: 4px;
}

.skeleton-pin {
  width: 20px;
  height: 26px;
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  background: linear-gradient(90deg, #e2e8f0 25%, #f1f5f9 50%, #e2e8f0 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.2s ease-in-out infinite;
}

.skeleton-list-item {
  display: flex;
  gap: 12px;
  padding: 12px;
  margin-bottom: 8px;
}

.skeleton-list-thumb {
  width: 56px;
  height: 56px;
  border-radius: var(--radius-md);
  background: linear-gradient(90deg, #e2e8f0 25%, #f1f5f9 50%, #e2e8f0 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.2s ease-in-out infinite;
  flex-shrink: 0;
}

.skeleton-list-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
  justify-content: center;
}

.skeleton-text {
  height: 14px;
  border-radius: 4px;
  background: linear-gradient(90deg, #e2e8f0 25%, #f1f5f9 50%, #e2e8f0 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.2s ease-in-out infinite;
}

.skeleton-text.short { width: 60%; }
.skeleton-text.medium { width: 80%; }
.skeleton-text.long { width: 100%; }

/* ========== æŒ‰é’®æ¶Ÿæ¼ªæ•ˆæœ ========== */
.ripple-btn {
  position: relative;
  overflow: hidden;
}

.ripple-btn::after {
  content: "";
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
  background-image: radial-gradient(circle, rgba(255,255,255,0.3) 10%, transparent 10%);
  background-repeat: no-repeat;
  background-position: 50%;
  transform: scale(10, 10);
  opacity: 0;
  transition: transform 0.4s, opacity 0.8s;
}

.ripple-btn:active::after {
  transform: scale(0, 0);
  opacity: 0.3;
  transition: 0s;
}

/* ========== æˆåŠŸ/å¤±è´¥åé¦ˆ ========== */
@keyframes successPop {
  0% { transform: scale(0.8); opacity: 0; }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes errorShake {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-6px); }
  40%, 80% { transform: translateX(6px); }
}

@keyframes checkmark {
  0% { stroke-dashoffset: 50; }
  100% { stroke-dashoffset: 0; }
}

.feedback-toast {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 12px 24px;
  border-radius: var(--radius-lg);
  font-size: 14px;
  font-weight: 600;
  z-index: 9999;
  display: flex;
  align-items: center;
  gap: 10px;
  animation: successPop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: var(--shadow-lg);
}

.feedback-toast.success {
  background: var(--success);
  color: white;
}

.feedback-toast.error {
  background: var(--danger);
  color: white;
  animation: successPop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), errorShake 0.4s 0.3s;
}

.feedback-toast.info {
  background: var(--accent);
  color: white;
}

.feedback-toast .toast-icon {
  font-size: 18px;
}

/* ========== æŒ‰é’®ç‚¹å‡»æ•ˆæœå¢å¼º ========== */
.toolbar button:active,
.menu-btn:active,
.action-btn:active,
.sort-btns button:active,
.login-btn:active {
  transform: scale(0.95);
}

/* ========== åŠ è½½ä¸­æŒ‰é’® ========== */
.btn-loading {
  position: relative;
  color: transparent !important;
  pointer-events: none;
}

.btn-loading::after {
  content: "";
  position: absolute;
  width: 16px;
  height: 16px;
  top: 50%;
  left: 50%;
  margin: -8px 0 0 -8px;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: white;
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
}

/* ========== å›¾ç‰‡åŠ è½½å ä½ ========== */
.img-placeholder {
  background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--bg-hover) 50%, var(--bg-tertiary) 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.2s ease-in-out infinite;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
  font-size: 24px;
}

/* ========== æ‚¬æµ®å¡ç‰‡æ•ˆæœ ========== */
.hover-lift {
  transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s;
}

.hover-lift:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

/* ========== ç‚¹å‡»æ³¢çº¹ï¼ˆå…¨å±€ï¼‰ ========== */
.click-feedback {
  position: fixed;
  pointer-events: none;
  z-index: 9998;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--accent);
  opacity: 0.4;
  transform: translate(-50%, -50%) scale(0);
  animation: clickFeedback 0.4s ease-out forwards;
}

@keyframes clickFeedback {
  0% { transform: translate(-50%, -50%) scale(0); opacity: 0.4; }
  100% { transform: translate(-50%, -50%) scale(3); opacity: 0; }
}

/* ========== ç…§ç‰‡æœç´¢é¢æ¿ ========== */
.photo-search-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(4px);
  z-index: 1600;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.2s;
}

.photo-search-panel {
  background: var(--bg-secondary);
  border-radius: var(--radius-xl);
  width: 480px;
  max-width: calc(100vw - 40px);
  max-height: calc(100vh - 80px);
  display: flex;
  flex-direction: column;
  box-shadow: var(--shadow-xl);
  animation: scaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  overflow: hidden;
}

.photo-search-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 18px 20px;
  border-bottom: 1px solid var(--border-light);
  background: linear-gradient(180deg, var(--bg-tertiary), transparent);
}

.photo-search-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.photo-search-input-wrap {
  padding: 16px;
  border-bottom: 1px solid var(--border-light);
  display: flex;
  align-items: center;
  gap: 10px;
}

.photo-search-input-wrap input {
  flex: 1;
  padding: 12px 16px;
  border: 1px solid var(--border);
  background: var(--bg-primary);
  color: var(--text-primary);
  font-size: 14px;
  border-radius: var(--radius-md);
  outline: none;
  transition: all 0.2s;
}

.photo-search-input-wrap input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-light);
}

.photo-search-results {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
  max-height: 400px;
}

.photo-search-item {
  display: flex;
  gap: 14px;
  padding: 12px;
  cursor: pointer;
  border-radius: var(--radius-md);
  transition: all 0.2s;
  margin-bottom: 6px;
  border: 1px solid transparent;
}

.photo-search-item:hover {
  background: var(--accent-light);
  border-color: var(--accent);
  transform: translateX(4px);
}

.photo-search-thumb {
  width: 64px;
  height: 64px;
  object-fit: cover;
  flex-shrink: 0;
  border-radius: var(--radius-md);
  background: var(--bg-tertiary);
  box-shadow: var(--shadow-sm);
}

.photo-search-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 6px;
  min-width: 0;
}

.photo-search-note {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-primary);
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.photo-search-location {
  font-size: 12px;
  color: var(--text-muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ========== ç…§ç‰‡ç¼–è¾‘å™¨ï¼ˆç°ä»£åŒ– UIï¼‰ ========== */
.photo-editor-overlay {
  position: fixed;
  inset: 0;
  background: #000;
  z-index: 2100;
  animation: fadeIn 0.2s;
}

.photo-editor-modern {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  background: #000;
}

/* é¡¶éƒ¨æ  - iOS é£æ ¼ */
.pe-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  z-index: 20;
}

.pe-btn {
  padding: 8px 16px;
  border: none;
  background: none;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
  border-radius: 8px;
  transition: all 0.2s;
}

.pe-cancel:hover {
  background: rgba(255,255,255,0.1);
}

.pe-done {
  color: rgba(255,255,255,0.3);
  font-weight: 600;
}

.pe-done.active {
  color: #0a84ff;
}

.pe-done.active:hover {
  background: rgba(10, 132, 255, 0.15);
}

.pe-done:disabled {
  cursor: not-allowed;
}

.pe-title {
  color: #fff;
  font-size: 17px;
  font-weight: 600;
}

/* å›¾ç‰‡åŒºåŸŸ */
.pe-canvas-area {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  padding: 60px 20px 100px;
  overflow: hidden;
}

.pe-image-container {
  position: relative;
  max-width: 100%;
  max-height: 100%;
  cursor: crosshair;
}

.pe-image-container img {
  display: block;
  max-width: 100%;
  max-height: calc(100vh - 200px);
  object-fit: contain;
  user-select: none;
  pointer-events: none;
  transition: transform 0.3s ease;
}

/* è£å‰ªé®ç½© */
.pe-crop-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}

/* è£å‰ªæ¡† */
.pe-crop-box {
  position: absolute;
  border: 2px solid #fff;
  background: transparent;
  box-shadow: 0 0 0 9999px rgba(0,0,0,0.6);
  cursor: move;
}

/* ç½‘æ ¼çº¿ */
.pe-grid {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.pe-grid-h, .pe-grid-v {
  position: absolute;
  background: rgba(255,255,255,0.3);
}

.pe-grid-h {
  left: 0;
  right: 0;
  height: 1px;
}

.pe-grid-v {
  top: 0;
  bottom: 0;
  width: 1px;
}

/* è§’è½æ‰‹æŸ„ */
.crop-handle {
  position: absolute;
  width: 24px;
  height: 24px;
  z-index: 10;
}

.crop-handle::before,
.crop-handle::after {
  content: '';
  position: absolute;
  background: #fff;
}

/* å·¦ä¸Šè§’ */
.crop-handle.tl { top: -3px; left: -3px; cursor: nwse-resize; }
.crop-handle.tl::before { width: 24px; height: 3px; top: 0; left: 0; }
.crop-handle.tl::after { width: 3px; height: 24px; top: 0; left: 0; }

/* å³ä¸Šè§’ */
.crop-handle.tr { top: -3px; right: -3px; cursor: nesw-resize; }
.crop-handle.tr::before { width: 24px; height: 3px; top: 0; right: 0; }
.crop-handle.tr::after { width: 3px; height: 24px; top: 0; right: 0; }

/* å·¦ä¸‹è§’ */
.crop-handle.bl { bottom: -3px; left: -3px; cursor: nesw-resize; }
.crop-handle.bl::before { width: 24px; height: 3px; bottom: 0; left: 0; }
.crop-handle.bl::after { width: 3px; height: 24px; bottom: 0; left: 0; }

/* å³ä¸‹è§’ */
.crop-handle.br { bottom: -3px; right: -3px; cursor: nwse-resize; }
.crop-handle.br::before { width: 24px; height: 3px; bottom: 0; right: 0; }
.crop-handle.br::after { width: 3px; height: 24px; bottom: 0; right: 0; }

/* å³ä¾§å¤åŸæŒ‰é’® */
.pe-reset-btn {
  position: absolute;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  width: 44px;
  height: 44px;
  border: none;
  background: rgba(255,255,255,0.15);
  color: #fff;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  backdrop-filter: blur(10px);
}

.pe-reset-btn svg {
  width: 20px;
  height: 20px;
  fill: currentColor;
}

.pe-reset-btn:hover {
  background: rgba(255,255,255,0.25);
  transform: translateY(-50%) scale(1.1);
}

/* æç¤ºæ–‡å­— */
.pe-hint {
  position: absolute;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  color: rgba(255,255,255,0.5);
  font-size: 14px;
  pointer-events: none;
}

/* çŠ¶æ€æŒ‡ç¤º */
.pe-status {
  position: absolute;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 12px;
  pointer-events: none;
}

.pe-status-item {
  background: rgba(255,255,255,0.15);
  color: #fff;
  padding: 6px 12px;
  border-radius: 16px;
  font-size: 12px;
  font-weight: 500;
  backdrop-filter: blur(10px);
}

/* åº•éƒ¨å·¥å…·æ  - å›ºå®šå¸ƒå±€ */
.pe-toolbar {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 20px;
  background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
}

.pe-tool {
  width: 48px;
  height: 48px;
  border: none;
  background: rgba(255,255,255,0.1);
  color: #fff;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.pe-tool svg {
  width: 22px;
  height: 22px;
  fill: currentColor;
}

.pe-tool:hover {
  background: rgba(255,255,255,0.2);
  transform: scale(1.1);
}

.pe-tool:active {
  transform: scale(0.95);
}


/* ========== å†…å­˜ç›‘æ§é¢æ¿ï¼ˆå¼€å‘æ¨¡å¼ï¼‰ ========== */
.memory-monitor-toggle {
  position: fixed;
  bottom: 20px;
  left: 20px;
  width: 36px;
  height: 36px;
  border: none;
  background: rgba(0, 0, 0, 0.6);
  color: white;
  border-radius: 50%;
  cursor: pointer;
  font-size: 16px;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  backdrop-filter: blur(10px);
}

.memory-monitor-toggle:hover {
  background: rgba(0, 0, 0, 0.8);
  transform: scale(1.1);
}

.memory-monitor-panel {
  position: fixed;
  bottom: 70px;
  left: 20px;
  width: 200px;
  background: rgba(0, 0, 0, 0.85);
  color: white;
  border-radius: 12px;
  padding: 12px;
  font-size: 12px;
  z-index: 9999;
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.mm-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
  font-weight: 600;
}

.mm-header button {
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.6);
  cursor: pointer;
  font-size: 16px;
  padding: 0;
  width: 20px;
  height: 20px;
}

.mm-header button:hover {
  color: white;
}

.mm-section {
  margin-bottom: 12px;
}

.mm-section:last-child {
  margin-bottom: 0;
}

.mm-title {
  color: rgba(255, 255, 255, 0.6);
  margin-bottom: 6px;
  font-size: 11px;
  text-transform: uppercase;
}

.mm-row {
  display: flex;
  justify-content: space-between;
  padding: 2px 0;
}

.mm-value {
  color: #4ade80;
  font-family: monospace;
}

.mm-total {
  margin-top: 4px;
  padding-top: 4px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  font-weight: 600;
}

.mm-bar {
  height: 4px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 2px;
  margin-top: 6px;
  overflow: hidden;
}

.mm-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, #4ade80, #facc15, #ef4444);
  border-radius: 2px;
  transition: width 0.3s;
}
